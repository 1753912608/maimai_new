<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>个人中心</title>
    <script src="https://cdn.bootcss.com/vue/2.6.8/vue.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <link href="css/personCenter.css" type="text/css" rel="stylesheet" />
    <script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>
<body>
<div id="app">
    <div>
        <el-container>
            <el-header class="header" height="65px">
                <ul style="list-style:none;margin-top:10px;">
                    <li style="float:left;margin-left:280px;">
                        <a href="javascript:void(0);"><img src="/img/logo_maimai.png" alt="" width="42px"></a>
                    </li>
                    <li style="float:left;margin-left:40px;margin-top:10px;">
                        <a href="javascript:void(0);" class="el-a-link">首页</a>
                    </li>
                    <li style="float:left;margin-left:50px;margin-top:10px;">
                        <a href="javascript:void(0);" class="el-a-link">实名动态</a>
                    </li>
                    <li style="float:left;margin-left:50px;margin-top:10px;">
                        <a href="javascript:void(0);" class="el-a-link">招聘管理</a>
                    </li>
                    <li style="float:left;margin-left:50px;margin-top:10px;">
                        <a href="javascript:void(0);" class="el-a-link">聊天</a>
                    </li>
                    <li style="float:left;margin-left:350px;margin-top:10px;">
                        <a href="javascript:void(0);" class="el-a-link">肖茗夫</a>
                    </li>
                    <li style="float:left;margin-left:10px;margin-top:5px;">
                        <a href="javascript:void(0);" class="el-a-link">
                            <img src="/img/edit_person.png" alt="" width="30px">
                        </a>
                    </li>
                    <li style="float:left;margin-left:50px;margin-top:10px;">
                        <a href="javascript:void(0);" class="el-a-link" @click="layOut">退出</a>
                    </li>
                </ul>
            </el-header>
            <el-main class="main">
                <div style="width:100%;height:100px;background-color:#ededeb;"></div>
                <!--基本信息-->
                <div class="el-info_content" style="height:300px;">
                    <div style="margin-left:20px;padding-top:15px;">
                        <span class="el-info-tag">基本信息</span>
                        <span style="float:left;margin-left:600px;">
                            <a href="javascript:void(0);" @click="modifyBasicInfo">
                                <i class="el-icon-edit-outline" style="font-size:24px;"></i>
                            </a>
                        </span>
                    </div>
                    <div style="margin-top:60px;margin-left:20px;">
                        <label class="el-info-label">真实姓名:</label>
                        <span style="margin-left:40px;">{{basicInfo.realName}}</span>
                    </div>
                    <div style="margin-top:20px;margin-left:20px;">
                        <label class="el-info-label">您的性别:</label>
                        <span style="margin-left:40px;">{{basicInfo.sex}}</span>
                    </div>
                    <div style="margin-top:20px;margin-left:20px;">
                        <label class="el-info-label">行业方向:</label>
                        <span style="margin-left:40px;">{{basicInfo.value}}&nbsp;{{basicInfo.value1}}</span>
                    </div>
                    <div style="margin-top:20px;margin-left:20px;">
                        <label class="el-info-label">当前公司:</label>
                        <span style="margin-left:40px;">{{basicInfo.company}}</span>
                    </div>
                    <div style="margin-top:20px;margin-left:20px;">
                        <label class="el-info-label">当前职位:</label>
                        <span style="margin-left:40px;">{{basicInfo.position}}</span>
                    </div>
                </div>
                <!--基本信息的编辑框-->
                <el-dialog title="编辑基本信息" :visible.sync="basicInfo.dialogVisible" width="25%">
                    <div style="margin-top:10px;">
                        <span>
                            <el-input v-model="basicInfo.realName" style="width:125px;height:40px;"></el-input>
                        </span>
                        <span style="margin-left:25px;">
                            <el-radio v-model="basicInfo.sex" label="男" border class="el-input-border">男</el-radio>
                            <el-radio v-model="basicInfo.sex" label="女" border class="el-input-border" style="margin-left:-30px;">女</el-radio>
                        </span>
                    </div>
                    <div style="margin-top:10px;float:left;">
                        <el-dropdown split-button>
                            {{basicInfo.value}}
                            <el-dropdown-menu slot="dropdown" style="width:120px;">
                                <el-dropdown-item
                                        v-for="(x,index) in basicInfo.work_direction"
                                        @click.native="test(x.profession,index)">{{x.profession}}
                                </el-dropdown-item>
                            </el-dropdown-menu>
                        </el-dropdown>
                    </div>
                    <div style="float:left;margin-left:30px;margin-top:10px;">
                        <el-dropdown split-button>
                            {{basicInfo.value1}}
                            <el-dropdown-menu slot="dropdown" style="width:120px;">
                                <el-dropdown-item
                                        v-for="x in basicInfo.work_direction[basicInfo.selectedProfessionIndex].major"
                                        @click.native="test1(x)">{{x}}
                                </el-dropdown-item>
                            </el-dropdown-menu>
                        </el-dropdown>
                    </div>
                    <div style="margin-top:60px;">
                        <el-input v-model="basicInfo.company" style="width:305px;height:40px;" placeholder="当前公司"></el-input>
                    </div>
                    <div style="margin-top:10px;">
                        <el-input v-model="basicInfo.position" style="width:305px;height:40px;" placeholder="当前职位"></el-input>
                    </div>
                    <div style="margin-top:50px;margin-left:140px;">
                        <span slot="footer" class="dialog-footer">
                          <el-button @click="basicInfo.dialogVisible = false">取 消</el-button>
                          <el-button type="primary" @click="updateBasicInfo">确 定</el-button>
                        </span>
                    </div>
                </el-dialog>
                <!--职业标签-->
                <div class="el-info_content" style="height:150px;margin-top:20px;">
                    <div style="margin-left:20px;padding-top:15px;">
                        <span class="el-info-tag">职业标签</span>
                        <span style="float:left;margin-left:600px;">
                            <a href="javascript:void(0);" @click="modifyWorkTag">
                                <i class="el-icon-edit-outline" style="font-size:24px;"></i>
                            </a>
                        </span>
                    </div>
                    <div style="margin-top:60px;margin-left:20px;">
                        <span style="margin-left:20px;" v-for="item in workTag.myTagList"><el-button type="primary" round>{{item}}</el-button></span>
                    </div>
                </div>
                <!--编辑职业标签-->
                <el-dialog title="编辑职业标签" :visible.sync="workTag.dialogVisible" width="40%">
                    <div>
                        <el-tag
                                v-for="(tag,index) in workTag.myTagList"
                                closable
                                style="width:100px;margin-left:10px;">
                            {{tag}}
                        </el-tag>
                    </div>
                    <div style="margin-top:10px;margin-left:10px;background-color:#f0f0f0;width:540px;height:240px;">
                        <div style="margin-left:20px;padding-top:20px;">
                            <span><el-input style="width:300px;border:2px solid #e4e4e4" v-model="workTag.tagInput"></el-input></span>
                            <span style="margin-left:20px;"><el-button type="primary" style="width:100px;" @click="pushMyListByInput">添加</el-button></span>
                        </div>
                        <div style="color:#333;margin-top:20px;margin-left:20px;">
                            常用标签:
                        </div>
                        <div style="margin-left:10px;margin-top:20px;">
                            <span v-for="(item,index) in workTag.defaultTagList" style="margin-left:10px;">
                                <el-button type="primary" plain style="width:100px;" @click="pushMyListByDefault(index)">{{item}}</el-button>
                            </span>
                        </div>
                    </div>
                    <div style="margin-top:50px;margin-left:200px;">
                        <span slot="footer" class="dialog-footer">
                          <el-button @click="workTag.dialogVisible = false">取 消</el-button>
                          <el-button type="primary" @click="workTag.dialogVisible = false">保存</el-button>
                        </span>
                    </div>
                </el-dialog>
                <!--求职信息-->
                <div class="el-info_content" style="height:180px;margin-top:20px">
                    <div style="margin-left:20px;padding-top:15px;">
                        <span class="el-info-tag">求职信息</span>
                        <span style="float:left;margin-left:600px;">
                            <a href="javascript:void(0);" @click="modifyJobInfo">
                                <i class="el-icon-edit-outline" style="font-size:24px;"></i>
                            </a>
                        </span>
                    </div>
                    <div style="margin-top:60px;margin-left:20px;">
                        <label class="el-info-label">学历:</label>
                        <span style="margin-left:70px;">其他</span>
                    </div>
                    <div style="margin-top:20px;margin-left:20px;">
                        <label class="el-info-label">期望薪资:</label>
                        <span style="margin-left:40px;">未知</span>
                    </div>
                </div>
                <el-dialog title="编辑求职信息" :visible.sync="jobInfo.dialogVisible" width="25%">
                    <div style="margin-top:10px;float:left;margin-left:50px;">
                        <el-dropdown split-button>
                            {{jobInfo.education}}
                            <el-dropdown-menu slot="dropdown" style="width:100px;">
                                <el-dropdown-item
                                        v-for="(x,index) in jobInfo.educationList"
                                        @click.native="test2(x)">{{x}}
                                </el-dropdown-item>
                            </el-dropdown-menu>
                        </el-dropdown>
                    </div>
                    <div style="float:left;margin-left:40px;margin-top:10px;">
                        <el-dropdown split-button>
                            {{jobInfo.expect_Salary}}
                            <el-dropdown-menu slot="dropdown" style="width:150px;">
                                <el-dropdown-item
                                        v-for="(x,index) in jobInfo.expect_SalaryList"
                                        @click.native="test3(x)">{{x}}
                                </el-dropdown-item>
                            </el-dropdown-menu>
                        </el-dropdown>
                    </div>
                    <div style="margin-top:70px;margin-left:90px;">
                        <span slot="footer" class="dialog-footer">
                          <el-button @click="jobInfo.dialogVisible = false">取 消</el-button>
                          <el-button type="primary" @click="jobInfo.dialogVisible = false">保存</el-button>
                        </span>
                    </div>
                </el-dialog>
                <!--联系方式-->
                <div class="el-info_content" style="height:180px;margin-top:20px;">
                    <div style="margin-left:20px;padding-top:15px;">
                        <span class="el-info-tag">联系方式</span>
                        <span style="float:left;margin-left:600px;">
                            <a href="javascript:void(0);" @click="modifyContactInfo">
                                <i class="el-icon-edit-outline" style="font-size:24px;"></i>
                            </a>
                        </span>
                    </div>
                    <div style="margin-top:60px;margin-left:20px;">
                        <label class="el-info-label">工作地点:</label>
                        <span style="margin-left:40px;">北京,海淀区</span>
                    </div>
                    <div style="margin-top:20px;margin-left:20px;">
                        <label class="el-info-label">邮箱:</label>
                        <span style="margin-left:70px;">1753972608@qq.com</span>
                    </div>
                </div>
                <!--编辑联系方式-->
                <el-dialog title="编辑求职信息" :visible.sync="contactInfo.dialogVisible" width="25%">
                    <div>
                        <el-input style="width:300px;border:2px solid #e4e4e4" placeholder="工作地点" v-model="contactInfo.workBase"></el-input>
                    </div>
                    <div style="margin-top:20px;">
                        <el-input style="width:300px;border:2px solid #e4e4e4" placeholder="邮箱" v-model="contactInfo.mail"></el-input>
                    </div>
                    <div style="margin-top:70px;margin-left:90px;">
                        <span slot="footer" class="dialog-footer">
                          <el-button @click="contactInfo.dialogVisible = false">取 消</el-button>
                          <el-button type="primary" @click="contactInfo.dialogVisible = false">保存</el-button>
                        </span>
                    </div>
                </el-dialog>
                <!--简历-->
                <div class="el-info_content" style="height:220px;margin-top:20px;">
                    <div style="margin-left:20px;padding-top:15px;">
                        <span class="el-info-tag">简历附件</span>
                    </div>
                    <div style="margin-top:60px;" :style="{display:resume.resumeState==='none'?'block':'none'}">
                        <div class="resumeUpload">
                            <div class="uploadBox">
                                <a href="javascript:void(0);" for="uploadBtn" class="uploadBox_text">上传简历附件</a>
                            </div>
                            <p style="text-align:center;padding-top:16px;color:#999999;">格式仅支持pdf、doc、docx、png不超过20M</p>
                        </div>
                        <input type="file" name="ResumeFile" accept=".doc,.docx,.pdf,.jpg,.png" id="uploadBtn" @change="upload">
                    </div>
                    <div style='margin-top:60px;' :style="{display:resume.resumeState}">
                        <div style="margin-left:200px;margin-top:40px;float:left;">
                            <img :src="resume.resumeImg" alt="" width="48px" height="48px">
                        </div>
                        <div style="float:left;margin-left:20px;margin-top:40px;">
                            <div style="color:rgb(120,120,120)">{{resume.resumeName}}</div>
                            <div style="margin-top:5px;color:rgb(120,120,120)">{{resume.resumeTime}}上传</div>
                        </div>
                        <div style="float:left;margin-left:50px;margin-top:50px;">
                            <a href="javascript:void(0);" style="text-decoration:none;color:rgb(120,120,120)">删除</a>
                        </div>
                    </div>
                </div>
            </el-main>
        </el-container>
    </div>
</div>
</body>
<script>
    new Vue({
        el: '#app',
        data:{
            basicInfo:{
                realName: '',
                sex: '',
                work_direction:[{
                      profession: 'IT互联网',
                      major:['销售','研发','运营/编辑','产品','测试','运维/安全','人力HR','设计']
                    },{
                      profession: '文化传媒',
                      major:['行政人事','销售','设计/动画','高管','品牌/公关','策划','市场商务']
                    },{
                      profession: '通信电子',
                      major:['销售','生产制造','工程/维护','技工普工','硬件研发','经营管理','采购物控']
                    },{
                      profession:'金融',
                      major:['销售/理财','财税审计','银行','高管','保险','市场商务','风投/投行','交易证券']
                    },{
                      profession: '教育培训',
                      major:['市场销售','职业技能','幼教','小学教师','艺术体育','初中教师','行政/人事']
                    },{
                      profession: '医疗生物',
                      major:['销售','医生','护士/护理','经营管理','行政人事','保健按摩','医药生产','医学研发']
                    },{
                      profession: '房产建筑',
                      major:['装修施工','项目管理','销售/经纪人','设计规划','行政人事','市场商务','质检造价']
                    },{
                      profession: '化工能源',
                      major:['生产制造','发电/传输','油煤矿产','销售客户','化工技术','经营管理','环保/水处理']
                    }
                ],
                company: '',
                position: '',
                dialogVisible:false,
                selectedProfessionIndex: 0,
                selectedMajorIndex: 0,
                value:'IT互联网',
                value1: '研发'
            },
            workTag:{
                dialogVisible: false,
                defaultTagList: ['社交','研发','SNS','Linux系统','iphone开发','移动互联网','Java','前端'],
                myTagList: ['研发','Java'],
                tagInput: ''
            },
            jobInfo:{
                education: '本科',
                educationList: ['本科','专科','硕士','博士','博士后','其他'],
                expect_Salary: '未知',
                expect_SalaryList: ['3000及以下/月','3000-7000/月','7000-15000/月','15000-30000/月','30000以上/月'],
                dialogVisible: false
            },
            contactInfo:{
                workBase: '',
                mail: '',
                dialogVisible: false
            },
            resume: {
                resumeImg: '',
                resumeName: '',
                resumeTime: '',
                resumeState: 'none'
            }
        },
        created(){
            this.getMyUserInfo();
        },
        methods:{
            test(value,index){
                this.basicInfo.value=value;
                this.basicInfo.selectedProfessionIndex=index;
            },
            test1(value){
               this.basicInfo.value1=value;
            },
            test2(value){
                this.jobInfo.education=value;
            },
            test3(value){
                this.jobInfo.expect_Salary=value;
            },
            modifyBasicInfo(){
                this.basicInfo.dialogVisible=true;
            },
            modifyWorkTag(){
                this.workTag.dialogVisible=true;
            },
            modifyJobInfo(){
               this.jobInfo.dialogVisible=true;
            },
            modifyContactInfo(){
                this.contactInfo.dialogVisible=true;
            },
            pushMyListByDefault(index){
                this.workTag.myTagList.push(this.workTag.defaultTagList[index]);
                this.workTag.defaultTagList.splice(index,1);
            },
            pushMyListByInput(){
                this.workTag.myTagList.push(this.workTag.tagInput);
                this.workTag.tagInput='';
            },
            upload(){
                let fileName=document.getElementById("uploadBtn").files[0].name;
                if(fileName.substring(fileName.lastIndexOf('.')+1)==='pdf'){
                    this.resume.resumeImg='/img/pdf.png';
                }else if(fileName.substring(fileName.lastIndexOf('.')+1)==='doc'){
                    this.resume.resumeImg='/img/doc.png';
                }else if(fileName.substring(fileName.lastIndexOf('.')+1)==='docx'){
                    this.resume.resumeImg='/img/doc.png';
                }else if(fileName.substring(fileName.lastIndexOf('.')+1)==='png'){
                    this.resume.resumeImg='/img/png.png';
                }
                this.resume.resumeName=fileName;
                let date=new Date();
                this.resume.resumeTime=date.getFullYear()+'-'+(date.getMonth()+1)+'-'+date.getDay()+' '+date.getHours()+':'+date.getMinutes()+':'+date.getSeconds();
                this.resume.resumeState='block';
            },
            removeResume(){

            },
            layOut(){
               axios.get('/layOut');
               window.location.href="/test_login";
            },
            async getMyUserInfo(){
                let result=await axios.get('/getMyUserInfo');
                this.basicInfo.realName=result.data.user_real_name;
                this.basicInfo.sex=result.data.user_sex;
                this.basicInfo.company=result.data.user_company;
                this.basicInfo.position=result.data.user_position;
                this.basicInfo.value=result.data.user_work_direction.split(" ")[0];
                this.basicInfo.value1=result.data.user_work_direction.split(" ")[1];
                //this.workTag.myTagList=result.data.user_tag.split(" ");
            },
            async updateBasicInfo(){
                let result=await axios.get('/updateBasicInfo?realName='+this.basicInfo.realName+'&sex='+this.basicInfo.sex+'&company='+this.basicInfo.company+'&position='+this.basicInfo.position+'&work_direction='+this.basicInfo.value+' '+this.basicInfo.value1);
                if(result.data===1){
                    this.$message({
                        showClose: true,
                        message: '更新基本信息成功',
                        type: 'success'
                    });
                    window.location.href="/center";
                }else{
                    this.$message({
                        showClose: true,
                        message: '更新个人信息失败',
                        type: 'error'
                    });
                }
            },
            updateJobInfo(){

            },
            updateWorkTag(){

            },
            updateContactInfo(){

            }
        }
    })
</script>
</html>